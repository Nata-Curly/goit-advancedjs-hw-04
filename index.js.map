{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/services/BtnService.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '35898178-628df3d5ceb1661a68afdf1ae';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nasync function getPixabayPhotos({ query, page, perPage }) {\n  const res = await axios.get('', {\n    params: {\n      key: API_KEY,\n      q: query,\n      page,\n      per_page: perPage,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    },\n  });\n  return res.data;\n}\n\nexport { getPixabayPhotos };\n","export default function createGalleryCard(cards) {\n  return cards\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n    <div class=\"info\">\n         <p class=\"info-item\"><b>Likes</b> ${likes}</p>\n          <p class=\"info-item\"><b>Views</b> ${views}</p>\n          <p class=\"info-item\"><b>Comments</b> ${comments}</p>\n          <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\n          </div>\n  </a>\n</li>`\n    )\n    .join('');\n}\n","export default class BtnService {\n  static HIDDEN_CLASS = 'is-hidden';\n  constructor(button) {\n    this.button = button;\n    this.prevText = '';\n  }\n\n  disable() {\n    this.button.disabled = true;\n  }\n\n  enable() {\n    this.button.disabled = false;\n  }\n\n  hide() {\n    this.button.classList.add(BtnService.HIDDEN_CLASS);\n  }\n\n  show() {\n    this.button.classList.remove(BtnService.HIDDEN_CLASS);\n  }\n\n  setLoading() {\n    this.disable();\n    this.prevText = this.button.textContent;\n    this.button.textContent = 'Loading...';\n  }\n\n  setNorman() {\n    this.button.textContent = this.prevText;\n    this.enable();\n  }\n}\n\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getPixabayPhotos } from './js/pixabay-api';\nimport createGalleryCard from './js/render-functions';\nimport BtnService from './js/services/BtnService';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionSelector: 'img',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  enableKeyboard: true,\n  animationSlide: true,\n  overlay: true,\n});\n\nconst searchForm = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nconst loadMoreBtnService = new BtnService(loadMoreBtn);\n\nconst params = {\n  page: 1,\n  per_page: 20,\n  maxPage: 1,\n  query: '',\n};\n\nfunction loader() {\n  gallery.innerHTML = '<div class=\"loader\"></div>';\n}\n\nsearchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  loadMoreBtnService.hide();\n  params.page = 1;\n\n  const form = event.currentTarget;\n  const userQuery = form.elements.query.value.trim();\n\n  loader();\n\n  if (userQuery === '') {\n    form.reset();\n    iziToast.warning({\n      title: 'Warning',\n      message: 'You should enter something to start the search!',\n    });\n\n    return;\n  }\n\n  params.query = userQuery;\n\n  try {\n    const data = await getPixabayPhotos(params);\n\n    if (data.total === 0) {\n      gallery.innerHTML = '';\n      iziToast.warning({\n        title: 'Warning',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    params.maxPage = Math.ceil(data.totalHits / params.per_page);\n\n    gallery.innerHTML = createGalleryCard(data.hits);\n    iziToast.success({\n      title: 'OK',\n      message: `Hooray! We found ${\n        data.totalHits\n      } photos of ${userQuery.trim()}.`,\n    });\n    lightbox.refresh();\n\n    if (params.maxPage > params.page) {\n      loadMoreBtnService.show();\n\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    }\n  } catch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: err.message,\n    });\n  } finally {\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  loadMoreBtnService.setLoading();\n  params.page += 1;\n\n  try {\n    const data = await getPixabayPhotos(params);\n    const photosMarkup = createGalleryCard(data.hits);\n\n    gallery.insertAdjacentHTML('beforeend', photosMarkup);\n\n    lightbox.refresh();\n\n    window.scrollBy({\n      top: 560,\n      behavior: 'smooth',\n    });\n\n    loadMoreBtnService.setNorman();\n\n    if (params.maxPage === params.page) {\n      loadMoreBtnService.hide();\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n      iziToast.info({\n        title: 'Info!',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: err.message,\n    });\n  }\n}\n"],"names":["API_KEY","axios","getPixabayPhotos","query","page","perPage","createGalleryCard","cards","webformatURL","largeImageURL","tags","likes","views","comments","downloads","_BtnService","button","__publicField","BtnService","lightbox","SimpleLightbox","searchForm","gallery","loadMoreBtn","loadMoreBtnService","params","loader","handleSearch","event","form","userQuery","iziToast","data","handleLoadMore","err","photosMarkup"],"mappings":"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"}